<ion-header translucent="true">

  <!-- top title bar with menu & title ibgib -->
  <ion-toolbar id="top-title-bar">
    <ion-buttons slot="start">
      <ion-menu-button slot="icon-only"></ion-menu-button>
      <ion-button *ngIf="showBackChevronBtn"
        class="back-btn"
        (click)="handleBackButtonClick()"
        >
        <ion-icon name="chevron-back-outline" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>

      <!-- atow, i am doing selective titles in ibgib-component-base.ts title property  -->
    <ion-title *ngIf='isTag' class='toolbar-title-yo'>
      <tag-view [addr]='item.addr'> </tag-view>
    </ion-title>
    <ion-title *ngIf='isPic' class='pic-title toolbar-title-yo'>
      <ion-thumbnail>
        <pic-view [addr]='item.addr' [isTitleOrJustSmall]='true' (click)="showFullscreenModal()"></pic-view>
      </ion-thumbnail>
    </ion-title>
    <ion-title *ngIf='isComment' class='comment-title toolbar-title-yo' (click)="handleTitleClick()">
        <comment-view [addr]='item.addr' [isTitleOrJustSmall]='true'></comment-view>
    </ion-title>
    <ion-title *ngIf='isRoot' class='toolbar-title-yo'>
      <root-view [addr]='item.addr'> </root-view>
    </ion-title>
    <ion-title *ngIf='!isTag && !isPic && !isComment && !isRoot' class='toolbar-title-yo'>
      {{ title }}
    </ion-title>
  </ion-toolbar>

  <!-- ibgib context buttons -->
  <ion-toolbar color="background">
    <ion-buttons id="context-btns" slot="end">
      <!-- leaving these in for future testing of download the d*$! pic -->
      <!-- <ion-button *ngIf="item?.type === 'pic' && (ios || android)" class="toolbar-title-btn" -->
      <ion-button *ngIf="item?.type === 'pic'" class="toolbar-title-btn"
        [disabled]="syncing || refreshing" (click)="handleUpdatePicClick()">
        <ion-icon name="camera-reverse-outline"></ion-icon>
        <ion-spinner *ngIf="updatingPic" name="circles" color="tertiary"></ion-spinner>
      </ion-button>
      <ion-button *ngIf="item?.type === 'pic' && (ios || android)" class="toolbar-title-btn"
        [disabled]="syncing || refreshing" (click)="handleDownloadPicClick()">
        <ion-icon name="download-outline"></ion-icon>
        <ion-icon name="image-outline"></ion-icon>
        <ion-spinner *ngIf="downloadingPic" name="circles" color="tertiary"></ion-spinner>
      </ion-button>
      <a *ngIf="item?.type === 'pic' && web" [href]="item.picSrc"
        [download]="'Downloads/' + (item?.filenameWithExt || 'item.binHash.png')">
        <ion-button [disabled]="syncing || refreshing" class="toolbar-title-btn">
          <ion-icon name="download-outline"></ion-icon>
          <ion-icon name="image-outline"></ion-icon>
        </ion-button>
      </a>
      <ion-button *ngIf="ibGib"
        class="toolbar-title-btn"
        (click)="handleShareClick()">
        <ion-icon name="share-social-outline" ios="share-outline"></ion-icon>
      </ion-button>
      <ion-button *ngIf="ibGib" [disabled]="refreshing"
        class="toolbar-title-btn"
        (click)="handleRobbotClick()"
        [ngClass]="{'active-btn':robbotBarIsVisible}"
        >
        <ion-icon name="body-outline"></ion-icon>
      </ion-button>
      <ion-button *ngIf="tjp" [disabled]="syncing || refreshing"
        [ngClass]="{'active-btn': autosync}"
        class="toolbar-title-btn"
        (click)="handleSpaceClick()">
        <ion-icon name="sparkles-outline"></ion-icon>
      </ion-button>
      <ion-button *ngIf="tjp"
        [disabled]="syncing || refreshing"
        class="toolbar-title-btn"
        (click)="handleSyncClick()">
        <ion-badge *ngIf="syncErrored" color="danger" slot="start">
          <ion-icon name="alert-circle-outline"></ion-icon>
        </ion-badge>
        <ion-label>
          <ion-icon name="rocket-outline"></ion-icon>
          <ion-icon name="sync-outline"></ion-icon>
        </ion-label>
        <ion-spinner *ngIf="syncing" name="circles" color="tertiary"></ion-spinner>
        <ion-badge *ngIf="tjpUpdatesAvailableCount_Store" color="primary" slot="end">
          {{ tjpUpdatesAvailableCount_Store }}
        </ion-badge>
      </ion-button>
      <ion-button [disabled]="syncing || refreshing || paused || tagging"
        class="toolbar-title-btn"
        (click)="handleTagClick($event)">
        <ion-icon name="pricetag-outline"></ion-icon>
        <ion-spinner *ngIf="tagging" name="bubbles" color="tertiary"></ion-spinner>
      </ion-button>
      <ion-button *ngIf="gib !== 'gib'"
        [disabled]="refreshing"
        [ngClass]="{'active-btn':!paused}"
        class="toolbar-title-btn"
        (click)="handleRefreshClick()">
        <ion-icon *ngIf="!refreshing" name="refresh"></ion-icon>
        <ion-spinner *ngIf="refreshing" name="bubbles" color="tertiary"></ion-spinner>
        <ion-badge *ngIf="tjpUpdatesAvailableCount_Local" color="primary" slot="end">
          {{ tjpUpdatesAvailableCount_Local }}
        </ion-badge>
      </ion-button>
      <ion-button [disabled]="refreshing"
        class="toolbar-title-btn"
        (click)="handleInfoClick($event)">
        <ion-icon name="information-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content #ibgibPageContent
  [fullscreen]="false" [forceOverscroll]="false"
  >

  <ion-text *ngIf="statusText" color="primary">{{statusText}}</ion-text>

  <!-- spinnerwhale -->
  <div *ngIf="!item?.ibGib || refreshing" class="loading-div">
    <!-- <p>loading...</p> -->
    <div class="spacer-50"></div>
    <div class="loading-hair">
      <ion-spinner name="lines-small" color="tertiary"></ion-spinner>
      <ion-spinner class="slant-left" name="dots" color="tertiary"></ion-spinner>
      <ion-spinner class="slant-right" name="dots" color="tertiary"></ion-spinner>
      <ion-spinner name="lines-small" color="tertiary"></ion-spinner>
    </div>
    <div class="loading-hair">
      <ion-spinner class="slant-left" name="dots" color="tertiary"></ion-spinner>
      <ion-spinner class="move-up" name="dots" color="tertiary"></ion-spinner>
      <ion-spinner class="move-up" name="dots" color="tertiary"></ion-spinner>
      <ion-spinner class="slant-right" name="dots" color="tertiary"></ion-spinner>
    </div>
    <div class="loading-eyes">
      <ion-spinner class="slant-left" name="dots" color="tertiary"></ion-spinner>
      <ion-spinner class="move-up" name="bubbles" color="tertiary"></ion-spinner>
      <ion-spinner class="move-up" name="bubbles" color="tertiary"></ion-spinner>
      <ion-spinner class="slant-right" name="dots" color="tertiary"></ion-spinner>
    </div>
    <div class="loading-hair">
      <ion-spinner color="tertiary"></ion-spinner>
      <ion-spinner class="slant-right" name="dots" color="tertiary"></ion-spinner>
      <ion-spinner class="slant-left" name="dots" color="tertiary"></ion-spinner>
      <ion-spinner color="tertiary"></ion-spinner>
    </div>
    <div class="loading-hair">
      <ion-spinner color="tertiary"></ion-spinner>
      <ion-spinner class="slant-left" name="dots" color="tertiary"></ion-spinner>
      <ion-spinner class="slant-right" name="dots" color="tertiary"></ion-spinner>
      <ion-spinner color="tertiary"></ion-spinner>
    </div>
  </div>

  <!-- main body -->
  <div id="container" *ngIf="item?.ibGib"
    [style.border-color]="debugBorderColor"
    [style.border-width]="debugBorderWidth"
    [style.border-style]="debugBorderStyle"
    >

    <ib-robbot-bar *ngIf="robbotBarIsVisible" [addr]='addr'></ib-robbot-bar>

    <tag-list *ngIf='isTags' [addr]='addr' [ibGib_Context]='ibGib'
      (scroll)="scrollSubject.next($event)"
      >
    </tag-list>
    <root-list *ngIf='isRoots' [addr]='addr' [ibGib_Context]='ibGib'
      (scroll)="scrollSubject.next($event)"
      >
    </root-list>
    <chat-view #chatView *ngIf='!(isTags || isRoots)'
      [addr]='addr'
      [ibGib_Context]='ibGib'
      (scroll)="scrollSubject.next($event)"
      (chatItemsAdded)="handleChatItemsAdded()"
      >
    </chat-view>

    <ion-modal [isOpen]="showModal_PromptForTag">
      <ng-template>
        <ion-content id="select-tag-content">
          <ion-title id="select-tag-title">Select tag...</ion-title>
          <ion-buttons id="select-tag-btns">
            <ion-button *ngFor="let tag of tagIbGibs"
              class="select-tag-btn"
              (click)="handleSelectTag_ExistingTag(tag)"
              color="primary"
              >
              <ion-icon [name]="tag.data?.icon || 'help-outline'"></ion-icon>
              <ion-label>{{ tag.data?.text || '[tag text missing?]' }} </ion-label>
            </ion-button>
          </ion-buttons>
          <ion-buttons id="select-tag-btns-special">
            <ion-button (click)="handleSelectTag_New()"
              color="secondary">
              <ion-icon name="add-outline"></ion-icon>
              <ion-label>new tag...</ion-label>
            </ion-button>
            <ion-button (click)="handleSelectTag_Cancel()"
              color="danger">
              <ion-icon name="close-outline"></ion-icon>
              <ion-label>cancel</ion-label>
            </ion-button>
          </ion-buttons>
        </ion-content>
      </ng-template>
    </ion-modal>

  </div>

</ion-content>

<!-- <ion-modal #bottomSheet id="bottom-sheet-modal"
  [isOpen]="true"
  [breakpoints]="[0.1, 1]"
  [initialBreakpoint]="1"
  [backdropBreakpoint]="1"
  canDismiss="false"
>
  <ng-template>
    <ion-content>
      <action-bar #actionBar [addr]='addr' [ibGib_Context]='ibGib'></action-bar>
    </ion-content>
  </ng-template>
</ion-modal> -->
<!-- <ion-footer [style.height]="actionBar.actionDetailVisible ? '33%' : '6%'"> -->
<ion-footer>
  <action-bar #actionBar [addr]='addr' [ibGib_Context]='ibGib'></action-bar>
</ion-footer>
